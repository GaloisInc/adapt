# PPM Tree Evaluation

### Prerequisites

You will need to have Python 3 installed to run `processAlarmFiles.py` as well as several libraries. I recommend using the Anaconda distribution of Python which comes with all of the necessary libraries.

Check out the command line options by running `./processAlarmFiles.py --help`.

### Examples

To find reasonable local probability thresholds for Cadet's alarm files and save them, run 
`./processAlarmFiles.py --ta1 cadets --alarmdir /path/to/alarm/dir/ --savefilteredalarms`.

To generate a CSV of local probability distributions for each tree, run
`./processAlarmFiles.py --ta1 cadets --alarmdir /path/to/alarm/dir/ --lpdist --nothresholds`.

Details on attacks and the methods that detected them as well as true/false positives on our methods can be found by running
`./processAlarmFiles.py --ta1 cadets --alarmdir /path/to/alarm/dir/`.

You can see how well our unfiltered alarms did at detecting attacks by running
`./processAlarmFiles.py --ta1 cadets --alarmdir /path/to/alarm/dir/ --nothresholds`.

To use previously generated local probability thresholds, rather than finding new ones, run 
`./processAlarmFiles.py --ta1 cadets --alarmdir /path/to/alarm/dir/ --loadthresholds`.

To learn when alarms occur overtime (using previously saved local probability thresholds), try running 
`./processAlarmFiles.py --ta1 cadets --alarmdir /path/to/alarm/dir/ --loadthresholds --timeseries`.

### Notes

- Filtered alarms are saved to the same directory the unfiltered ones are found in. 
- All saved CSVs generated by `processAlarmFiles.py` can be found in the `stats` directory.
- The `attackFiles` directory contains two sets of ground truth keyword files: those matching `*_attacksFR.csv` contain keywords derived from the object column of Kudu's reported attack components; and those matching `*_attacks.csv` contain keywords derived before access to Kudu's attack-component report was available (but after some of the ground truth documents were shared).
