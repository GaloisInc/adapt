{
    "netflow" : {
        "instance_set" : "g.V().hasLabel('Entity-NetFlow').id()",
        "feature_set" : {
            "writeBytes":
                "g.V({id}).both().both().has('eventType',21).values('size').sum()",
            "readBytes":
                "g.V({id}).both().both().has('eventType',17).values('size').sum()",
            "numWrites":
                "g.V({id}).both().both().has('eventType',21).count()",
            "numReads":
                "g.V({id}).both().both().has('eventType',17).count()",
            "numOpen":
                "g.V({id}).both().both().has('eventType',16).count()",
            "numClose":
                "g.V({id}).both().both().has('eventType',5).count()"
        }
    },

    "process" : {
        "instance_set" : "g.V().has('subjectType',0).id()",
        "feature_set" : {
            "nFilesOpenDuringWrToNetFlow":
                "g.V({id}).as('process').both().both().has('eventType',21).as('writeNetflow').both().both().has(label,'Entity-NetFlow').select('process').both().both().has('eventType',16).as('openFile').both().both().has(label,'Entity-File').select('writeNetflow','openFile').by('startedAtTime').where('writeNetflow',gte('openFile')).count()",
            "numDistDstPortAccess":
                "g.V({id}).both().both().has('subjectType',4).both().both().has(label,'Entity-NetFlow').values('dstPort').dedup().count()",
            "numDistSrcPortAccess":
                "g.V({id}).both().both().has('subjectType',4).both().both().has(label,'Entity-NetFlow').values('srcPort').dedup().count()",
            "tBytesSentToNetFlow":
                "g.V({id}).both().both().has('eventType',21).as('event').both().both().has(label,'Entity-NetFlow').select('event').by('size').sum()",
            "tBytesRcvFromNetFlow":
                "g.V({id}).both().both().has('eventType',17).as('event').both().both().has(label,'Entity-NetFlow').select('event').by('size').sum()",
            "numWritesToNetFlow":
                "g.V({id}).both().both().has('eventType',21).both().both().has(label,'Entity-NetFlow').count()",
            "numReadsToNetFlow":
                "g.V({id}).both().both().has('eventType',17).both().both().has(label,'Entity-NetFlow').count()"
        }
    },

    "file" : {
        "instance_set" : "g.V().hasLabel('Entity-File').id()",
        "feature_set" : {
            "num_exec":
                "g.V({id}).both().both().has('eventType',3).count()",
            "num_close":
                "g.V({id}).both().both().has('eventType',5).count()",
            "num_chk_attrib":
                "g.V({id}).both().both().has('eventType',9).count()",
            "num_modify_attrib":
                "g.V({id}).both().both().has('eventType',14).count()",
            "num_open":
                "g.V({id}).both().both().has('eventType',16).count()",
            "num_read":
                "g.V({id}).both().both().has('eventType',17).count()",
            "num_rename":
                "g.V({id}).both().both().has('eventType',20).count()",
            "num_write":
                "g.V({id}).both().both().has('eventType',21).count()",
            "num_uploads":
                "g.V({id}).both().both().has('eventType',17).as('file_read').both().both().has('subjectType',0).as('process').both().both().has('eventType',21).as('netflow_write').both().both().has(label,'Entity-NetFlow').dedup().count()"
        }
    },

    "file_open_close_gap" : {
        "instance_set": "g.V().has(label,'Entity-File').as('files').both().both().has('eventType',16).select('files').both().both().has('eventType',5).select('files').dedup().id()",
        "feature_set": {
            "open_close_gap":
                "g.V({id}).both().both().has('eventType',5).values('startedAtTime').max().next() - g.V({id}).both().both().has('eventType',16).values('startedAtTime').min().next()"
        }
    },

    "file_dnld_exec_gap" : {
        "instance_set": "g.V().has(label,'Entity-File').as('files').both().both().has('eventType',21).both().both().has('subjectType',0).both().both().has('eventType',17).both().both().has(label,'Entity-NetFlow').select('files').dedup().as('d_files').both().both().has('eventType',9).select('d_files').dedup().id()",
        "feature_set": {
            "dnld_exec_gap":
                "g.V({id}).both().both().has('eventType',9).values('startedAtTime').min().next() - g.V({id}).both().both().has('eventType',21).values('startedAtTime').max().next()"
        }
    },

    "file_exec_del_gap" : {
        "instance_set": "g.V().has(label,'Entity-File').as('files').both().both().has('eventType',9).select('files').both().both().has('eventType',12).select('files').dedup().id()",
        "feature_set": {
            "exec_del_gap":
                "g.V({id}).both().both().has('eventType',9).values('startedAtTime').max().next() - g.V({id}).both().both().has('eventType',12).values('startedAtTime').min().next()"
        }
    },

    "netflow_open_close_gap" : {
        "instance_set": "g.V().has(label,'Entity-NetFlow').as('netflow').both().both().has('eventType',16).select('netflow').both().both().has('eventType',5).select('netflow').dedup().id()",
        "feature_set": {
            "open_close_gap":
                "g.V({id}).both().both().has('eventType',5).values('startedAtTime').max().next() - g.V({id}).both().both().has('eventType',16).values('startedAtTime').min().next()"
        }
    }
}
